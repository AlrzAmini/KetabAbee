@using KetabAbee.Domain.Models.Products
@model KetabAbee.Domain.Models.Products.Book
@{
    ViewData["Title"] = "افزودن کتاب جدید";
}
@{
    var publishers = ViewBag.Publishers as List<SelectListItem>;

    var groups = ViewBag.Groups as List<SelectListItem>;

    var subGroups = ViewBag.SubGroups as List<SelectListItem>;

    var sub2Groups = ViewBag.Sub2Groups as List<SelectListItem>;

    var selectAgeRanges = new List<SelectListItem>
    {
        new(){Text = "رنج سنی مناسب را انتخاب کنید",Value = ""}
    };
    selectAgeRanges.AddRange(Html.GetEnumSelectList<AgeRange>());

    var selectCoverTypes = new List<SelectListItem>
    {
        new(){Text = "نوع جلد را انتخاب کنید",Value = ""}
    };
    selectCoverTypes.AddRange(Html.GetEnumSelectList<CoverType>());

    var selectStatus = new List<SelectListItem>
    {
        new(){Text = "وضعیت موجودی را انتخاب کنید",Value = ""}
    };
    selectStatus.AddRange(Html.GetEnumSelectList<ExistStatus>());
}
<!-- Page Content -->
<!-- Page Breadcrumb -->
<div class="page-breadcrumbs margin-bottom-20">
    <ul class="breadcrumb">
        <li>
            <i class="fa fa-home"></i>
            <a asp-controller="AdminHome" asp-action="Home">خانه</a>
        </li>
        <li>
            <a asp-controller="AdminUser" asp-action="Index">کتاب ها</a>
        </li>
        <li class="active">@ViewData["Title"]</li>
    </ul>
</div>
<!-- /Page Breadcrumb -->
<form asp-area="AdminPanel" asp-controller="AdminBook" asp-action="AddBook" method="post" role="form" enctype="multipart/form-data">
    <div class="col-lg-8 col-sm-8 col-xs-12">
        <div class="widget flat radius-bordered">
            <div class="widget-header bg-blue">
                <span class="widget-caption">@ViewData["Title"]</span>
            </div>
            <div class="widget-body">
                <div id="registration-form">
                    <div class="form-title">
                        مشخصات کتاب
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <input type="text" class="form-control" asp-for="Name" placeholder="نام کتاب">
                            <i class="glyphicon glyphicon-book circular"></i>
                        </span>
                        <span asp-validation-for="Name" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <input type="number" class="form-control" asp-for="Price" placeholder="قیمت">
                            <i class="fa fa-money circular"></i>
                        </span>
                        <span asp-validation-for="Price" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <input type="text" class="form-control" asp-for="Writer" placeholder="نویسنده">
                            <i class="fa fa-user circular"></i>
                        </span>
                        <span asp-validation-for="Writer" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <input type="number" class="form-control" asp-for="PagesCount" placeholder="تعداد صفحه">
                            <i class="fa fa-book circular"></i>
                        </span>
                        <span asp-validation-for="PagesCount" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="GroupId" asp-items="groups" class="form-control"></select>
                        </span>
                        <span asp-validation-for="GroupId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="SubGroupId" asp-items="subGroups" class="form-control"></select>
                        </span>
                        <span asp-validation-for="SubGroupId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="SubGroup2Id" asp-items="sub2Groups" class="form-control"></select>
                        </span>
                        <span asp-validation-for="SubGroup2Id" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="PublisherId" asp-items="publishers" class="form-control"></select>
                        </span>
                        <span asp-validation-for="PublisherId" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="CoverType" asp-items="selectCoverTypes" class="form-control"></select>
                        </span>
                        <span asp-validation-for="CoverType" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="AgeRange" asp-items="selectAgeRanges" class="form-control"></select>
                        </span>
                        <span asp-validation-for="AgeRange" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <select asp-for="ExistStatus" asp-items="selectStatus" class="form-control"></select>
                        </span>
                        <span asp-validation-for="ExistStatus" class="text-danger"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4 col-sm-4 col-xs-12">
        <div class="widget flat radius-bordered">
            <div class="widget-header bg-azure">
                <span class="widget-caption">تصویر کتاب</span>
            </div>
            <div class="widget-body">
                <div id="registration-form">
                    <div class="form-group">
                        <span class="input-icon icon-right">
                            <input id="userAvatar" type="file" name="imgFile" class="form-control">
                            <i class="fa fa-image circular"></i>
                        </span>
                    </div>
                    <div class="form-group">
                        <img class="thumbnail img-fluid max-width100" id="imageUp" src="/images/Defualt.jpg" alt="book" />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <button type="submit" class="btn btn-success btn-lg btn-block">ثبت کتاب</button>
    </div>
</form>

<!-- /Page Content -->
@section Scripts
{
    <partial name="_ValidationScriptsPartial" />
    <script>
        $("#GroupId").change(function () {
            $("#SubGroupId").empty();
            $.getJSON("/AdminPanel/AdminHome/GetSubGroups/" + $("#GroupId :selected").val(),
                function (data) {
                    $.each(data,
                        function () {
                            $("#SubGroupId").append('<option value=' + this.value + '>' + this.text + '</option>');
                        });
                });
        });
        $("#SubGroupId").change(function () {
            $("#SubGroup2Id").empty();
            $.getJSON("/AdminPanel/AdminHome/GetSubGroups2/" + $("#SubGroupId :selected").val(),
                function (data) {
                    $.each(data,
                        function () {
                            $("#SubGroup2Id").append('<option value=' + this.value + '>' + this.text + '</option>');
                        });
                });
        });
    </script>
    <script type="text/javascript" src="/js/JalaliDataPicker-min.js"></script>
    <script>
        jalaliDatepicker.startWatch();
    </script>
    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $('#imageUp').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        $("#userAvatar").change(function () {
            readURL(this);
        });
    </script>
}

